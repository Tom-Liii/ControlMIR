# Code Checking
## `promax/controlnet_union_train_weather_new_vae.py`
- def main(): line 1095
    - initialize vae_enc and vae_dec: line 1193
    - initialize unet: line 1195
    - initialize controlnet: line 1216
    - set mode for vae, unet, text encoders and controlnet: line 1292
    - forget to add vae to optimizer: line 1356
# 250327-16:33
- currently only training the lora part of vae_enc and vae_dec
- input: gt
- loss: prediction vs. gt
- psnr: prediction vs. gt
- metrics should be quiet high

# TODO
- in futher training, can set 50% gt and 50% lq during training
- 